# 5장 기본 컴퓨터의 구조와 설계

## 기본 컴퓨터(Basic Computer)

- DEC. Corp 사의 중형 컴퓨터 PDP-11을 지칭

  - 이후 VAX-11등의 주요 minicomputer의 기본(1970 ~ 1980년대)

- 컴퓨터 구조 설계의 가장 기본적인 부분
- 현대의 CPU들에도 동일하게 적용되는 설계 구조

## 1. 명령어 코드

- 컴퓨터의 동작

  - 레지스터 내에 저장된 데이터에 대한 마이크로 연산의 시퀀스에 의하여 정의
  - 범용 컴퓨터 시스템에서는 다양한 마이크로 연산 시퀀스를 정의

- 명령어 코드

  - 컴퓨터에게 어떤 특별한 동작을 수행할 것을 알리는 비트들의 집합
  - 연산 코드들로 구성

- 컴퓨터 명령어

  - 컴퓨터에 대한 일련의 마이크로 연산을 기술
  - 이진 코드로 구성
  - 데이터와 함께 메모리에 저장

- 프로그램

  - 사용자가 원하는 연산과 피연산자가 처리되는 순서를 기술한 컴퓨터 명령어의 집합
  - 명령어 처리 과정을 제어

- 내장 프로그램

  - 제어 신호에 의하여 명령어의 이진 코드를 해석하여 실행
  - 명령어를 저장하여 실행하는 컴퓨터 구동 방식

- 저장(내장) 프로그램 구조

  - 명령어의 집합으로 구성
  - 각 명령어는 명령어 포맷(Instruction format)에 따라서 정의
  - 프로그램 실행 부분에 따라서 메모리의 다른 부분(segment)에 저장
  - 명령어 실행 결과는 AC에 저장

- 간접 주소(Indirect Address) 시스템

  - 많은 경우, 직접 주소를 사용하여 데이터 지정
  - 필요한 경우, 간접 주소로 데이터 지정

## 2. 컴퓨터 레지스터

- 기본 컴퓨터의 레지스터

  - 기본 컴퓨터란?

    - DEC PDP-11 Mini Computer
    - 가상의 컴퓨터가 아닌 실제 제품
    - 1980년대 주력 메인프레임급
    - 최신 CPU도 기본적으로 동일한 구조

- 버스 시스템의 종류

  - 내부 버스

    - CPU(컴퓨터) 내부 레지스터간 연결

  - 외부 버스

    - CPU 내부 레지스터 - 메모리간 연결

  - 입출력 버스

    - CPU <-> 주변장치(I/O) 연결

- 공통 버스 시스템

  - 내부 버스를 통칭
  - 내부 버스의 크기(Width)로 CPU 워드 크기 결정

    - 16bit 컴퓨터 - 내부 버스/레지스터 크기가 16bit
    - 32bit 컴퓨터 - 내부 버스/레지스터 크기가 32bit

  - 전송 연결 통로

    - 레지스터-레지스터 데이터 전송 통로
    - 레지스터-메모리 데이터 전송 통로(예외적 표현)
    - 한 순간에는 하나의 전송 신호만이 버스에 존재 가능

      - 2개 이상의 신호 발생시에는 버스 충돌(Collision)발생
      - 버스 제어기(정확한 타이밍과 MUX 제어 수행)

- 공통 버스 시스템

  - 레지스터 출력은 버스의 MUX 입력에 연결
  - 각 레지스터에 MUX 입력번호 설정됨
  - 레지스터 입력은 버스에 직접 연결(LD로 제어)
  - S2, S1, S0에 의하여 레지스터 출력 결정

- 버스의 동작

  - DR <- AC, AC <- DR
  - M[AR] <- DR
  - AR <- PC

- MUX Inputs

  1. 1: AR
  2. 2: PC
  3. 3: DR
  4. 4: AC
  5. 5: DR
  6. 6: TR
  7. 7: Memory

## 3. 컴퓨터 명령어

- 기존 컴퓨터 명령어의 종류

  - MRI 명령 7가지
  - RRI 명령 12가지
  - IO 명령 6가지

## 4. 타이밍과 제어

- 명령어 실행 타이밍 예

  - D3T4 : SC <- 0

## 5. 명령어 사이클

- 명령어 사이클 단계

  1. 메모리에서 명령어 가져오기(Fetch)
  2. 명령어 디코딩
  3. 유효주소(Effective Address) 계산
  4. 명령어 실행

- Fetch 와 Decode

  - T0 : AR <- PC(MUX 2 open, LD AR)
  - T1 : IR <- M[AR], PC <- PC + 1
  - T2 : D0 ... D7 <- decode IR(12-14), AR <- IR(0-11), I <- IR(15) (MUX 5 open, LD AR)

- 명령어의 종류 결정

  - MRI 명령어 여부
  - RRI 명령어 여부
  - IO 명령 결정

- 레지스터 참조 명령어의 종류와 동작

## 6. 메모리 참조 명령어

- 메모리 참조 명령어의 종류와 동작

  - AND
  - ADD
  - LDA
  - STA
  - BUN
  - BSA
  - ISZ

---

## 7. 입출력과 인터럽트

- 입출력 구성

  - CPU와 IO 장치의 속도 차이 제어를 위하여 Flag 사용

    - Buffer overrun 상태
    - Buffer udnerrun 상태

  - FGI

    - 1: 입력 가능한 상태
    - 0: 입력 블로킹

  - FGO 

    - 1: 출력 가능한 상태
    - 0: 출력장치 사용중

  - 인터럽트(Interrupt)

    - IEN flag에 의하여 제어
    - 입출력 전체를 제어

- 프로그램 인터럽트

  - 장치가 준비되었을 때 CPU에게 알림
  - 인터럽트 발생 시 BSA 명령어처럼 동작
  - FGI, FGO 플래그 사용

    - 플래그가 set 되면 R <- 1
    - R = 1이면 다음 명령어 사이클에 인터럽트 사이클 실행

  - IEN 

    - 인터럽트 enable/disable 제어

- I/O Program

  - 입출력 인터럽트 처리 루틴의 집합

- IVT(Interrupt Vector Table)

  - 각 인터럽트에 벡터번호 부여
  - 벡터번호와 인터럽트 처리 루틴 시작번지를 Table로 유지
  - 시스템 부팅시에 IVT는 0번 segment에 load
  - 현대의 대부분의 CPU가 IVT 사용

- 인터럽트 사이클(IC)

  - IC로 분기되는 조건

  - 인터럽트 사이클의 실행

## 8. 컴퓨터에 대한 완전한 기술

- 기본 컴퓨터(PDP-11)의 전체 명령어 set

## 9. 기본 컴퓨터의 설계

- 하드웨어 구성 요소

  - 16bit 4096워드 메모리
  - 9개의 레지스터

    - AR, PC, DR, AC, IR, TR, OUTR, INPR, SC

  - 7개의 플립플롭

    - I, S, E, R, IEN, FGI, FGO

  - 2개의 디코더

    - 3 x 8(Opcode), 4 x 16(타이밍)

  - 16bit 공통버스
  - 제어 논리 게이트
  - AC 입력 연결 논리회로(ALU)

- 컴퓨터의 동작 흐름

  - MRI, RRI, IO명령 사이클 구현
  - 인터럽트 사이클 구현

- 레지스터와 메모리에 대한 제어

  - AR 제어 논리 게이트의 예
  - 설계 순서

    - AR에 대한 LD, CLR, INC 동작의 경우 수집
    - 각 동작들은 OR로 연결

- 단일 플립플롭에 대한 제어

- 공통 버스에 대한 제어

## 10. 누산기 논리의 설계

- AC 레지스터 관련 회로

  - AC를 변경하는 경우 수집
  - LD, CLR, INC

- AC 레지스터에 대한 제어

  - LD 신호 제어

    - MRI 명령 : AND, ADD, LDA
    - RRI 명령 : COM, SHR, SHL
    - IO 명령 : INPR

  - INR 신호 제어

    - MRI 명령 : none
    - RRI 명령 : INC
    - IO 명령 : none

  - CLR 신호 제어

    - MRI 명령 : none
    - RRI 명령 : CLR
    - IO 명령 : none

- 가산 논리 회로

  - 회로 요소

    - AND gate
    - Full Adder
    - Inverter
    - Shifter
    - INPR/OUTR

